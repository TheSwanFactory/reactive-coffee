(function(){var t,n,e,r,u,i,o,s,a,c,l,f,h,p,d,g,y,v,b,m,w,x,k,S,C,A,j,M,O,R,D,B,I,T,U,E,N,P,H,F,q,Q,z,W,J,L,G,K,V,X,Y,Z,tn={}.hasOwnProperty,nn=function(t,n){function e(){this.constructor=t}for(var r in n)tn.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},en=[].slice,rn=this;"undefined"==typeof exports?this.rx=H={}:H=exports,R=0,O=function(){return R+=1},I=function(t,n){var e;if(!n in t)throw"object has no key "+n;return e=t[n],delete t[n],e},D=function(t,n,e){var r,u,i,o;for(r=i=0,o=t.length;o>i;r=++i)if(u=t[r],e(u)&&0>(n-=1))return[u,r];return[null,-1]},S=function(t,n){return D(t,0,n)},j=function(t){var n,e,r,u,i,o;if(null==t&&(t=[]),e=Object.create(null),_.isArray(t))for(u=0,i=t.length;i>u;u++)o=t[u],n=o[0],r=o[1],e[n]=r;else for(n in t)r=t[n],e[n]=r;return e},r=H.DepMgr=function(){function t(){this.uid2src={}}return t.prototype.sub=function(t,n){return this.uid2src[t]=n},t.prototype.unsub=function(t){return I(this.uid2src,t)},t}(),H._depMgr=w=new r,u=H.Ev=function(){function t(t){this.inits=t,this.subs=[]}return t.prototype.sub=function(t){var n,e,r,u,i;if(e=O(),null!=this.inits)for(i=this.inits(),r=0,u=i.length;u>r;r++)n=i[r],t(n);return this.subs[e]=t,w.sub(e,this),e},t.prototype.pub=function(t){var n,e,r,u;r=this.subs,u=[];for(e in r)n=r[e],u.push(n(t));return u},t.prototype.unsub=function(t){return I(this.subs,t),w.unsub(t,this)},t.prototype.scoped=function(t,n){var e;e=this.sub(t);try{return n()}finally{this.unsub(e)}},t}(),H.skipFirst=function(t){var n;return n=!0,function(e){return n?n=!1:t(e)}},p=H.Recorder=function(){function t(){this.stack=[],this.isMutating=!1,this.isIgnoring=!1,this.onMutationWarning=new u}return t.prototype.record=function(t,n){var e,r;this.stack.length>0&&!this.isMutating&&_(this.stack).last().addNestedBind(t),this.stack.push(t),r=this.isMutating,this.isMutating=!1,e=this.isIgnoring,this.isIgnoring=!1;try{return n()}finally{this.isIgnoring=e,this.isMutating=r,this.stack.pop()}},t.prototype.sub=function(t){var n,e;return this.stack.length>0&&!this.isIgnoring?(e=_(this.stack).last(),n=t(e)):void 0},t.prototype.addCleanup=function(t){return this.stack.length>0?_(this.stack).last().addCleanup(t):void 0},t.prototype.mutating=function(t){var n;this.stack.length>0&&(console.warn("Mutation to observable detected during a bind context"),this.onMutationWarning.pub(null)),n=this.isMutating,this.isMutating=!0;try{return t()}finally{this.isMutating=n}},t.prototype.ignoring=function(t){var n;n=this.isIgnoring,this.isIgnoring=!0;try{return t()}finally{this.isIgnoring=n}},t}(),H._recorder=P=new p,H.asyncBind=b=function(t,e){var r;return r=new n(e,t),r.refresh(),r},H.bind=m=function(t){return b(null,function(){return this.done(this.record(t))})},H.lagBind=A=function(t,n,e){var r;return r=null,b(n,function(){var n=this;return null!=r&&clearTimeout(r),r=setTimeout(function(){return n.done(n.record(e))},t)})},H.postLagBind=T=function(t,n){var e;return e=null,b(t,function(){var t,r,u,i=this;return u=this.record(n),r=u.val,t=u.ms,null!=e&&clearTimeout(e),e=setTimeout(function(){return i.done(r)},t)})},H.snap=function(t){return P.ignoring(t)},H.onDispose=function(t){return P.addCleanup(t)},H.autoSub=function(t,n){var e;return e=t.sub(n),H.onDispose(function(){return t.unsub(e)}),e},c=H.ObsCell=function(){function t(t){var n,e=this;this.x=t,this.x=null!=(n=this.x)?n:null,this.onSet=new u(function(){return[[null,e.x]]})}return t.prototype.get=function(){var t=this;return P.sub(function(n){return H.autoSub(t.onSet,function(){return n.refresh()})}),this.x},t}(),g=H.SrcCell=function(t){function n(){return V=n.__super__.constructor.apply(this,arguments)}return nn(n,t),n.prototype.set=function(t){var n=this;return P.mutating(function(){var e;return n.x!==t?(e=n.x,n.x=t,n.onSet.pub([e,t]),e):void 0})},n}(c),n=H.DepCell=function(t){function n(t,e){this.body=t,n.__super__.constructor.call(this,null!=e?e:null),this.refreshing=!1,this.nestedBinds=[],this.cleanups=[]}return nn(n,t),n.prototype.refresh=function(){var t,n,e,r,u,i=this;return this.refreshing?void 0:(e=this.x,r=function(t){return i.x=t,i.onSet.pub([e,i.x])},u=null,n=!1,t={record:function(e){var o,s;if(!i.refreshing){if(i.disconnect(),o)throw"this refresh has already recorded its dependencies";i.refreshing=!0,o=!0;try{s=P.record(i,function(){return e.call(t)})}finally{i.refreshing=!1}return n&&r(u),s}},done:function(t){return e!==t?i.refreshing?(n=!0,u=t):r(t):void 0}},this.body.call(t))},n.prototype.disconnect=function(){var t,n,e,r,u,i,o,s;for(o=this.cleanups,e=0,u=o.length;u>e;e++)t=o[e],t();for(s=this.nestedBinds,r=0,i=s.length;i>r;r++)n=s[r],n.disconnect();return this.nestedBinds=[],this.cleanups=[]},n.prototype.addNestedBind=function(t){return this.nestedBinds.push(t)},n.prototype.addCleanup=function(t){return this.cleanups.push(t)},n}(c),a=H.ObsArray=function(){function t(t){var n,e=this;this.xs=t,this.xs=null!=(n=this.xs)?n:[],this.onChange=new u(function(){return[[0,[],e.xs]]})}return t.prototype.all=function(){var t=this;return P.sub(function(n){return H.autoSub(t.onChange,function(){return n.refresh()})}),_.clone(this.xs)},t.prototype.raw=function(){var t=this;return P.sub(function(n){return H.autoSub(t.onChange,function(){return n.refresh()})}),this.xs},t.prototype.at=function(t){var n=this;return P.sub(function(e){return H.autoSub(n.onChange,function(n){var r,u,i;return u=n[0],i=n[1],r=n[2],u===t?e.refresh():void 0})}),this.xs[t]},t.prototype.length=function(){var t=this;return P.sub(function(n){return H.autoSub(t.onChange,function(t){var e,r,u;return r=t[0],u=t[1],e=t[2],u.length!==e.length?n.refresh():void 0})}),this.xs.length},t.prototype.map=function(t){var n;return n=new s,H.autoSub(this.onChange,function(e){var r,u,i;return u=e[0],i=e[1],r=e[2],n.realSplice(u,i.length,r.map(t))}),n},t.prototype.realSplice=function(t,n,e){var r;return r=this.xs.splice.apply(this.xs,[t,n].concat(e)),this.onChange.pub([t,r,e])},t}(),d=H.SrcArray=function(t){function n(){return X=n.__super__.constructor.apply(this,arguments)}return nn(n,t),n.prototype.spliceArray=function(t,n,e){var r=this;return P.mutating(function(){return r.realSplice(t,n,e)})},n.prototype.splice=function(){var t,n,e;return e=arguments[0],n=arguments[1],t=arguments.length>=3?en.call(arguments,2):[],this.spliceArray(e,n,t)},n.prototype.insert=function(t,n){return this.splice(n,0,t)},n.prototype.remove=function(t){var n;return n=_(this.raw()).indexOf(t),n>=0?this.removeAt(n):void 0},n.prototype.removeAt=function(t){return this.splice(t,1)},n.prototype.push=function(t){return this.splice(this.length(),0,t)},n.prototype.put=function(t,n){return this.splice(t,1,n)},n.prototype.replace=function(t){return this.spliceArray(0,this.length(),t)},n}(a),s=H.MappedDepArray=function(t){function n(){return Y=n.__super__.constructor.apply(this,arguments)}return nn(n,t),n}(a),t=H.DepArray=function(t){function n(t,e){var r=this;this.f=t,this.diff=e,n.__super__.constructor.call(this),H.autoSub(m(function(){return r.f()}).onSet,function(t){var n,e,u,i,o,s,a,c,l,f,h,p;for(o=t[0],c=t[1],null==o&&(o=[]),u=[0,o.length,c],a=null!=r.diff?null!=(h=B(o.length,c,r.diff(o,c)))?h:[u]:[u],p=[],l=0,f=a.length;f>l;l++)s=a[l],i=s[0],e=s[1],n=s[2],p.push(r.realSplice(i,e,n));return p})}return nn(n,t),n}(a),o=H.FakeSrcCell=function(t){function n(t,n){this._getter=t,this._setter=n}return nn(n,t),n.prototype.get=function(){return this._getter()},n.prototype.set=function(t){return this._setter(t)},n}(g),i=H.FakeObsCell=function(t){function n(t){this._getter=t}return nn(n,t),n.prototype.get=function(){return this._getter()},n}(c),v=H.MapEntryCell=function(t){function n(t,n){this._map=t,this._key=n}return nn(n,t),n.prototype.get=function(){return this._map.get(this._key)},n.prototype.set=function(t){return this._map.put(this._key,t)},n}(o),f=H.ObsMapEntryCell=function(t){function n(t,n){this._map=t,this._key=n}return nn(n,t),n.prototype.get=function(){return this._map.get(this._key)},n}(i),l=H.ObsMap=function(){function t(t){this.x=null!=t?t:{},this.onAdd=new u(function(){var n,e,r;r=[];for(n in t)e=t[n],r.push([n,e]);return r}),this.onRemove=new u,this.onChange=new u}return t.prototype.get=function(t){var n=this;return P.sub(function(e){return H.autoSub(n.onAdd,function(n){var r,u;return r=n[0],u=n[1],t===r?e.refresh():void 0})}),P.sub(function(e){return H.autoSub(n.onChange,function(n){var r,u,i;return u=n[0],r=n[1],i=n[2],t===u?e.refresh():void 0})}),P.sub(function(e){return H.autoSub(n.onRemove,function(n){var r,u;return u=n[0],r=n[1],t===u?e.refresh():void 0})}),this.x[t]},t.prototype.all=function(){var t=this;return P.sub(function(n){return H.autoSub(t.onAdd,function(){return n.refresh()})}),P.sub(function(n){return H.autoSub(t.onChange,function(){return n.refresh()})}),P.sub(function(n){return H.autoSub(t.onRemove,function(){return n.refresh()})}),_.clone(this.x)},t.prototype.realPut=function(t,n){var e;return t in this.x?(e=this.x[t],this.x[t]=n,this.onChange.pub([t,e,n]),e):(this.x[t]=n,this.onAdd.pub([t,n]),void 0)},t.prototype.realRemove=function(t){var n;return n=I(this.x,t),this.onRemove.pub([t,n]),n},t.prototype.cell=function(t){return new f(this,t)},t}(),y=H.SrcMap=function(t){function n(){return Z=n.__super__.constructor.apply(this,arguments)}return nn(n,t),n.prototype.put=function(t,n){var e=this;return P.mutating(function(){return e.realPut(t,n)})},n.prototype.remove=function(t){var n=this;return P.mutating(function(){return n.realRemove(t)})},n.prototype.cell=function(t){return new v(this,t)},n}(l),e=H.DepMap=function(t){function e(t){this.f=t,e.__super__.constructor.call(this),H.autoSub(new n(this.f).onSet,function(t){var n,e,r,u,i;e=t[0],u=t[1];for(n in e)r=e[n],!n in u&&this.realRemove(n);i=[];for(n in u)r=u[n],this.x[n]!==r?i.push(this.realPut(n,r)):i.push(void 0);return i})}return nn(e,t),e}(l),H.reactify=function(t,n){var e,r,u,i;return _.isArray(t)?(e=H.array(_.clone(t)),Object.defineProperties(t,_.object(function(){var n,u,i,o;for(i=_.functions(e),o=[],n=0,u=i.length;u>n;n++)r=i[n],"length"!==r&&o.push(function(n){var r,u,i;return r=t[n],u=function(){var u,i,o;return u=arguments.length>=1?en.call(arguments,0):[],null!=r&&(i=r.call.apply(r,[t].concat(en.call(u)))),(o=e[n]).call.apply(o,[e].concat(en.call(u))),i},i={configurable:!0,enumerable:!1,value:u,writable:!0},[n,i]}(r));return o}())),t):Object.defineProperties(t,_.object(function(){var t;t=[];for(u in n)i=n[u],t.push(function(t,n){var e,r,u,i,o;switch(e=null,n.type){case"cell":r=H.cell(null!=(i=n.val)?i:null),e={configurable:!0,enumerable:!0,get:function(){return r.get()},set:function(t){return r.set(t)}};break;case"array":u=H.reactify(null!=(o=n.val)?o:[]),e={configurable:!0,enumerable:!0,get:function(){return u.raw(),u},set:function(t){return u.splice.apply(u,[0,u.length].concat(en.call(t))),u}};break;default:throw"Unknown observable type: "+type}return[t,e]}(u,i));return t}()))},H.autoReactify=function(t){var n,e,r;return H.reactify(t,_.object(function(){var u,i,o,s;for(o=Object.getOwnPropertyNames(t),s=[],u=0,i=o.length;i>u;u++)n=o[u],r=t[n],r instanceof l||r instanceof c||r instanceof a||(e=_.isFunction(r)?null:_.isArray(r)?"array":"cell",s.push([n,{type:e,val:r}]));return s}()))},_.extend(H,{cell:function(t){return new g(t)},array:function(t){return new d(t)},map:function(t){return new y(t)}}),H.flatten=function(n){return new t(function(){var t;return _(function(){var e,r,u;for(u=[],e=0,r=n.length;r>e;e++)t=n[e],t instanceof a?u.push(t.raw()):t instanceof c?u.push(t.get()):u.push(t);return u}()).chain().flatten(!0).filter(function(t){return null!=t}).value()})},C=function(t){var n;return n=_.flatten(t),H.cellToArray(m(function(){return _.flatten(t)}))},H.cellToArray=function(n,e){return null==e&&(e=H.basicDiff()),new t(function(){return n.get()},e)},H.basicDiff=function(t){return null==t&&(t=H.smartUidify),function(n,e){var r,u,i,o,s,a,c;for(u=j(function(){var e,u,o;for(o=[],r=e=0,u=n.length;u>e;r=++e)i=n[r],o.push([t(i),r]);return o}()),c=[],o=0,s=e.length;s>o;o++)i=e[o],c.push(null!=(a=u[t(i)])?a:-1);return c}},H.uidify=function(t){var n;return null!=(n=t.__rxUid)?n:Object.defineProperty(t,"__rxUid",{value:O()}).__rxUid},H.smartUidify=function(t){return _.isObject(t)?H.uidify(t):JSON.stringify(t)},B=function(t,n,e){var r,u,i,o,s,a;if(o=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)u=e[t],u>=0&&r.push(u);return r}(),_.some(function(){var t,n,e;for(e=[],u=t=0,n=o.length-1;n>=0?n>t:t>n;u=n>=0?++t:--t)e.push(0>=o[u+1]-o[u]);return e}()))return null;for(a=[],i=-1,u=0;e.length>u;){for(;e.length>u&&e[u]===i+1;)i+=1,u+=1;for(s={index:u,count:0,additions:[]};e.length>u&&-1===e[u];)s.additions.push(n[u]),u+=1;r=u===e.length?t:e[u],s.count=r-(i+1),(s.count>0||s.additions.length>0)&&a.push([s.index,s.count,s.additions]),i=r,u+=1}return a},$.fn.rx=function(t){var n,e,r,u;return r=this.data("rx-map"),null==r&&this.data("rx-map",r=j()),t in r?r[t]:r[t]=function(){var r=this;switch(t){case"focused":return e=H.cell(this.is(":focus")),this.focus(function(){return e.set(!0)}),this.blur(function(){return e.set(!1)}),e;case"val":return u=H.cell(this.val()),this.change(function(){return u.set(r.val())}),this.on("input",function(){return u.set(r.val())}),u;case"checked":return n=H.cell(this.is(":checked")),this.change(function(){return n.set(r.is(":checked"))}),n;default:throw"Unknown reactive property type"}}.call(this)},"undefined"==typeof exports?this.rxt=F={}:F=exports,h=F.RawHtml=function(){function t(t){this.html=t}return t}(),k=["blur","change","click","dblclick","error","focus","focusin","focusout","hover","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","ready","resize","scroll","select","submit","toggle","unload"],z=F.specialAttrs={init:function(t,n){return n.call(t)}},L=function(t){return z[t]=function(n,e){return n[t](function(t){return e.call(n,t)})}};for(G=0,K=k.length;K>G;G++)x=k[G],L(x);N=["async","autofocus","checked","location","multiple","readOnly","selected","selectedIndex","tagName","nodeName","nodeType","ownerDocument","defaultChecked","defaultSelected"],E=_.object(function(){var t,n,e;for(e=[],t=0,n=N.length;n>t;t++)U=N[t],e.push([U,null]);return e}()),Q=function(t,n,e){return"value"===n?t.val(e):n in E?t.prop(n,e):t.attr(n,e)},q=function(t,n,e,r){return null==r&&(r=_.identity),e instanceof c?H.autoSub(e.onSet,function(e){var u,i;return i=e[0],u=e[1],Q(t,n,r(u))}):Q(t,n,r(e))},F.mktag=M=function(t){return function(n,e){var r,u,i,o,s,l,f,p,d,g;d=null==n&&null==e?[{},null]:null!=e?[n,e]:_.isString(n)||n instanceof Element||n instanceof h||n instanceof $||_.isArray(n)||n instanceof c||n instanceof a?[{},n]:[n,null],r=d[0],u=d[1],i=$("<"+t+"/>"),g=_.omit(r,_.keys(z));for(s in g)p=g[s],q(i,s,p);null!=u&&(l=function(t){var n,e,r,u,i;for(i=[],r=0,u=t.length;u>r;r++)if(n=t[r],_.isString(n))i.push(document.createTextNode(n));else if(n instanceof Element)i.push(n);else if(n instanceof h){if(e=$(n.html),1!==e.length)throw"RawHtml must wrap a single element";i.push(e[0])}else{if(!(n instanceof $))throw"Unknown element type in array: "+n.constructor.name+" (must be string, Element, RawHtml, or jQuery objects)";if(1!==n.length)throw"jQuery object must wrap a single element";i.push(n[0])}return i},f=function(t){var n;if(i.html(""),!_.isArray(t)){if(_.isString(t)||t instanceof Element||t instanceof h||t instanceof $)return f([t]);throw"Unknown type for element contents: "+t.constructor.name+" (accepted types: string, Element, RawHtml, jQuery object of single element, or array of the aforementioned)"}n=l(t),i.append(n)},u instanceof a?H.autoSub(u.onChange,function(t){var n,e,r,u;return e=t[0],r=t[1],n=t[2],i.contents().slice(e,e+r.length).remove(),u=l(n),e===i.contents().length?i.append(u):i.contents().eq(e).before(u)}):u instanceof c?H.autoSub(u.onSet,function(t){var n,e;return n=t[0],e=t[1],f(e)}):f(u));for(o in r)o in z&&z[o](i,r[o],r,u);return i}},J=["html","head","title","base","link","meta","style","script","noscript","body","body","section","nav","article","aside","h1","h2","h3","h4","h5","h6","h1","h6","header","footer","address","main","main","p","hr","pre","blockquote","ol","ul","li","dl","dt","dd","dd","figure","figcaption","div","a","em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","ruby","rt","rp","bdi","bdo","span","br","wbr","ins","del","img","iframe","embed","object","param","object","video","audio","source","video","audio","track","video","audio","canvas","map","area","area","map","svg","math","table","caption","colgroup","col","tbody","thead","tfoot","tr","td","th","form","fieldset","legend","fieldset","label","input","button","select","datalist","optgroup","option","select","datalist","textarea","keygen","output","progress","meter","details","summary","details","menuitem","menu"],F.tags=_.object(function(){var t,n,e;for(e=[],t=0,n=J.length;n>t;t++)W=J[t],e.push([W,F.mktag(W)]);return e}()),F.rawHtml=function(t){return new h(t)},F.importTags=function(t){return _(null!=t?t:rn).extend(F.tags)},F.cast=function(t,n){var e,r,u;return _.object(function(){var i;i=[];for(e in t)u=t[e],r=function(){switch(n[e]){case"array":if(u instanceof H.ObsArray)return u;if(_.isArray(u))return new H.DepArray(function(){return u});if(u instanceof H.ObsCell)return new H.DepArray(function(){return u.get()});throw"Cannot cast to array: "+u.constructor.name;case"cell":return u instanceof H.ObsCell?u:m(function(){return u});default:return u}}(),i.push([e,r]);return i}())},F.cssify=function(t){var n,e;return function(){var r;r=[];for(n in t)e=t[n],null!=e&&r.push(""+_.str.dasherize(n)+": "+(_.isNumber(e)?e+"px":e)+";");return r}().join(" ")},z.style=function(t,n){return q(t,"style",n,function(t){return _.isString(t)?t:F.cssify(t)})}}).call(this);