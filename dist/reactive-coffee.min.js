!function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B={}.hasOwnProperty,C=function(a,b){function c(){this.constructor=a}for(var d in b)B.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},D=[].slice,E=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};"undefined"==typeof exports?this.rx=v={}:v=exports,s=0,r=function(){return s+=1},t=function(a,b){var c;if(!b in a)throw"object has no key "+b;return c=a[b],delete a[b],c},j=function(){function a(){this.stack=[]}return a.prototype.start=function(a){return this.stack.push(a)},a.prototype.stop=function(){return this.stack.pop()},a.prototype.sub=function(a){var b,c;return this.stack.length>0?(c=_(this.stack).last(),b=a(c),c.addSub(b)):void 0},a.prototype.warnMutate=function(){return this.stack.length>0?console.warn("Mutation to observable detected during a bind context"):void 0},a}(),u=new j,v.bind=n=function(a){var b;return b=v.depCell(a),b.refresh(),b},v.lagBind=p=function(a,b){var c;return c=v.lagDepCell(b,a),c.refresh(),c},d=function(){function a(){this.uid2src={}}return a.prototype.sub=function(a,b){return this.uid2src[a]=b},a.prototype.unsub=function(a){return this.uid2src[a].unsub(a),t(this.uid2src,a)},a}(),o=new d,e=function(){function a(a){this.inits=a,this.subs=[]}return a.prototype.sub=function(a){var b,c,d,e,f;if(c=r(),null!=this.inits)for(f=this.inits(),d=0,e=f.length;e>d;d++)b=f[d],a(b);return this.subs[c]=a,o.sub(c,this),c},a.prototype.pub=function(a){var b,c,d,e;d=this.subs,e=[];for(c in d)b=d[c],e.push(b(a));return e},a.prototype.unsub=function(a){return t(this.subs,a)},a}(),h=function(){function a(a){var b,c=this;this.x=a,this.x=null!=(b=this.x)?b:null,this.onSet=new e(function(){return[[null,c.x]]})}return a.prototype.get=function(){var a=this;return u.sub(function(b){return a.onSet.sub(function(){return b.refresh()})}),this.x},a}(),l=function(a){function b(){return x=b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.set=function(a){var b;return u.warnMutate(),b=this.x,this.x=a,this.onSet.pub([b,a]),b},b}(h),b=function(a){function b(a,c,d){this.body=a,b.__super__.constructor.call(this,null!=c?c:null),this.subs=[],this.refreshing=!1,this.lag=null!=d?d:!1,this.timeout=null}return C(b,a),b.prototype.refresh=function(){var a,b=this;return a=function(){var a,c,d,e,f;if(!b.refreshing){for(a=b.x,f=b.subs,d=0,e=f.length;e>d;d++)c=f[d],o.unsub(c);b.subs=[],u.start(b),b.refreshing=!0;try{b.x=b.body()}finally{b.refreshing=!1,u.stop()}return b.onSet.pub([a,b.x])}},this.refreshing?void 0:this.lag?(null!=this.timeout&&clearTimeout(this.timeout),console.log("setting timeout"),this.timeout=setTimeout(a,500)):a()},b.prototype.addSub=function(a){return this.subs.push(a)},b}(h),g=function(){function a(a){var b,c=this;this.xs=a,this.xs=null!=(b=this.xs)?b:[],this.onChange=new e(function(){return[[0,[],c.xs]]})}return a.prototype.all=function(){var a=this;return u.sub(function(b){return a.onChange.sub(function(){return b.refresh()})}),this.xs},a.prototype.at=function(a){var b=this;return u.sub(function(c){return b.onChange.sub(function(b){var d,e,f;return e=b[0],f=b[1],d=b[2],e===a?c.refresh():void 0})}),this.xs[a]},a.prototype.length=function(){var a=this;return u.sub(function(b){return a.onChange.sub(function(a){var c,d,e;return d=a[0],e=a[1],c=a[2],e.length!==c.length?b.refresh():void 0})}),this.xs.length},a.prototype.map=function(a){var b;return b=new f,this.onChange.sub(function(c){var d,e,f;return e=c[0],f=c[1],d=c[2],b.realSplice(e,f.length,d.map(a))}),b},a.prototype.realSplice=function(a,b,c){var d;return d=this.xs.splice.apply(this.xs,[a,b].concat(c)),this.onChange.pub([a,d,c])},a}(),k=function(a){function b(){return y=b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.spliceArray=function(a,b,c){return u.warnMutate(),this.realSplice(a,b,c)},b.prototype.splice=function(){var a,b,c;return c=arguments[0],b=arguments[1],a=3<=arguments.length?D.call(arguments,2):[],this.spliceArray(c,b,a)},b.prototype.insert=function(a,b){return this.splice(b,0,a)},b.prototype.remove=function(a){return this.removeAt(_(this.all()).indexOf(a))},b.prototype.removeAt=function(a){return this.splice(a,1)},b.prototype.push=function(a){return this.splice(this.length(),0,a)},b.prototype.put=function(a,b){return this.splice(a,1,b)},b.prototype.replace=function(a){return this.spliceArray(0,this.length(),a)},b}(g),f=function(a){function b(){return z=b.__super__.constructor.apply(this,arguments)}return C(b,a),b}(g),a=function(a){function c(a){this.f=a,c.__super__.constructor.call(this),new b(this.f).onSet.sub(function(a){var b,c,d,e,f,g,h;return e=a[0],f=a[1],g=firstWhere(function(){h=[];for(var a=0,b=Math.min(e.length,f.length);b>=0?b>=a:a>=b;b>=0?a++:a--)h.push(a);return h}.apply(this),function(a){return e[a]!==f[a]}),d=g[0],d=g[1],d>-1?(c=e.length-d,b=f.slice(d),this.realSplice(d,c,b)):void 0})}return C(c,a),c}(g),i=function(){function a(a){this.x=null!=a?a:{},this.onAdd=new e(function(){var b,c,d;d=[];for(b in a)c=a[b],d.push([b,c]);return d}),this.onRemove=new e,this.onChange=new e}return a.prototype.get=function(a){var b=this;return u.sub(function(c){return b.onChange.sub(function(b){var d,e,f;return e=b[0],d=b[1],f=b[2],a===e?c.refresh():void 0})}),this.x[a]},a.prototype.all=function(){var a=this;return u.sub(function(b){return a.onChange.sub(function(){return b.refresh()})}),_.clone(this.x)},a.prototype.realPut=function(a,b){var c;return E.call(this.x,a)>=0?(c=this.x[a],this.x[a]=b,this.onChange.pub([a,c,b]),c):(this.x[a]=b,this.onAdd.pub([a,b]),void 0)},a.prototype.realRemove=function(a){var b;return b=t(this.x,a),this.onRemove.pub([a,b]),b},a}(),m=function(a){function b(){return A=b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.put=function(a,b){return u.warnMutate(),this.realPut(a,b)},b.prototype.remove=function(a){return u.warnMutate(),this.realRemove(a)},b}(i),c=function(a){function c(a){this.f=a,c.__super__.constructor.call(this),new b(this.f).onSet.sub(function(a){var b,c,d,e,f;c=a[0],e=a[1];for(b in c)d=c[b],!b in e&&this.realRemove(b);f=[];for(b in e)d=e[b],this.x[b]!==d?f.push(this.realPut(b,d)):f.push(void 0);return f})}return C(c,a),c}(i),_.extend(v,{cell:function(a){return new l(a)},array:function(a){return new k(a)},map:function(a){return new m(a)},depCell:function(a){return new b(a)},lagDepCell:function(a,c){return new b(a,c,!0)},depMap:function(a){return new c(a)},depArray:function(b){return new a(b)}}),$.fn.rx=function(a){var b,c,d,e;return d=$(this).data("rx-map"),null==d&&(d=$(this).data("rx-map",mkMap())),E.call(d,a)>=0?d[a]:d[a]=function(){switch(a){case"focused":return c=v.cell($(this).is(":focus")),$(this).focus(function(){return c.set(!0)}),$(this).blur(function(){return c.set(!1)}),n(function(){return c.get()});case"val":return e=v.cell($(this).val()),$(this).change(function(){return e.set(e)}),n(function(){return e.get()});case"checked":return b=v.cell($(this).is(":checked")),$(this).change(function(){return b.set($(this).is(":checked"))}),n(function(){return b.get()});default:throw"Unknown reactive property type"}}.call(this)},"undefined"==typeof exports?this.rxt=w={}:w=exports,w.mktag=q=function(a){return function(b,c){var d,e,f,i,j,k;d=$("<"+a+"/>"),j=_.omit(b,"init");for(e in j)i=j[e],i instanceof h?function(a){return i.onSet.sub(function(b){var c,e;return c=b[0],e=b[1],d.attr(a,e)})}(e):d.attr(e,i);if(null!=c)if(f=function(a){var b,c,e,f;if(d.html(""),a instanceof Array){for(f=[],c=0,e=a.length;e>c;c++)b=a[c],_.isString(b)&&(b=$("<span/>").text(b)),f.push(d.append(b));return f}throw"Unknown type for contents: "+a.constructor.name},c instanceof g)c.onChange.sub(function(a){var b,c,e,f,g;return e=a[0],f=a[1],b=a[2],d.children().slice(e,e+f.length).remove(),g=$(function(){var a,d,e;for(e=[],a=0,d=b.length;d>a;a++)c=b[a],e.push(c.get(0));return e}()),e===d.children().length?d.append(g):d.children().slice(e,e+1).before(g)});else if(c instanceof h)c.onSet.sub(function(a){var b,c;return b=a[0],c=a[1],f(c)});else{if(!(c instanceof Array))throw"Unknown type for contents: "+c.constructor.name;f(c)}return null!=(k=b.init)&&k.call(d),d}},w.br=q("br")({},[]),w.ul=q("ul"),w.li=q("li"),w.span=q("span"),w.anchor=q("a"),w.div=q("div"),w.input=q("input"),w.select=q("select"),w.select=function(a,b){return q("select")(a,b)},w.option=q("option"),w.option=function(a,b){return q("option")(a,b)},w.label=q("label"),w.button=q("button"),w.fieldset=q("fieldset"),w.legend=q("legend"),w.h1=q("h1"),w.h2=q("h2"),w.h3=q("h3"),w.h4=q("h4"),w.h5=q("h5"),w.h6=q("h6"),w.h7=q("h7")}.call(this);